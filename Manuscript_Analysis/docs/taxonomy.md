# Suptable_s1.py

Internal script
Run:

```
python3 uscripts/suptable_s1.py
```

### : Description :

Plot taxonomy signatures in AMPSphere candidates. 

### : Inputs :

1. **data/complete_amps_associated_taxonomy.tsv.gz:**

Table obtained during metadata processing. It contains detailed information about 
AMP genes, such as their start/end codons, GC contents, GTDB annotation of their 
contigs using MMSeqs2, and etc. Its columns are:

    amp - accession in AMPSphere v2022-03 resource
    gmsc - accession in the GMSC10 resource
    sample - biosample code
    contig - contig name
    start - gene start position in the contig
    stop - gene stop position in the contig
    strand - +1 or -1 for direct or reverse complement, respectively
    fid - random unique code for the gene in the contig
    partial - ends classification (complete genes - 00)
    start_type - start codon
    rbs_motif - ribosome binding motif
    rbs_spacer - ribosome binding motif spacer
    gc_cont - content of GC in percent
    taxid - NCBI taxID
    level - taxonomy level (Root, Kingdom, ..., genus, species)
    source - microbial source name
    retained - float
    assigned - float
    agreement - float
    support - probability, support measure, float
    specI - species cluster from ProGenomes2

### : Outputs :

1. **taxonomy_annotation.tsv**

Table from AMPSphere v2022-03 version. It consists in a table generated by filtering
the taxonomy assigned to contigs and AMP candidates. The AMP candidates assigned to
genus or species levels were considerd. This table has the info related to the
lowest taxonomic level each AMP had in AMPSphere. Its columns are:
    
    amp - accession in AMPSphere v2022-03 resource
    taxid - accession in NCBI taxID database
    level - lowest taxonomy classification (Unknown, Root, Kingdom, Phylum,
            Class, Order, Family, Genus, Species)
    source - taxon assigned to the contig from which the AMP was predicted
    fixed - one term designating taxonomy, here stands for genus

2. **result_tax.txt**

Table with two columns: AMP accession and taxonomy (level).
It represents the lowest level obtained per AMP (genus/species).

3. **top25genera.svg**

Vertical bar chart with the top 25 most represented taxa in AMPSphere.
The `x axis` are the genera and `y axis` are percent participation in AMPSphere.

4. **top10genera.svg**

Vertical bar chart with the top 10 most represented taxa in AMPSphere.
The `x axis` are the genera and `y axis` are percent participation in AMPSphere.

5. **taxonrank.svg**

Vertical stacked bar chart with the proportion of AMPs in AMPSphere annotated to the
lowest possible taxonomy level (Root, Kingdom, ..., genus, species).

